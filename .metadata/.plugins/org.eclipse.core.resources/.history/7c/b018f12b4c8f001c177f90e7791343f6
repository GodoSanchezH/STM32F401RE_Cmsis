/*
 * main.c
 *
 *  Created on: Feb 16, 2022
 *      Author: LENOVO
 */
#include "main.h"

void delay_ms(int time);

int main(void){
	  //	1. Habilitar clock GPIOA
	  RCC->AHB1ENR |= (1 << 0);									//	1: IO port A clock enabled
	  //	2. Configuraci贸n del PIN A5 como salida
	  GPIOA->MODER |=  (1 << 10);								//	01: General purpose output mode
	  GPIOA->MODER &= ~(1 << 11);
	  //	3. Configuraci贸n del modo de salida
	  GPIOA->OTYPER &= ~(1 << 5);								//	0: Output push-pull (reset state)
	  //	4. Configuraci贸n de la velocidad del pin
	  GPIOA->OSPEEDR |= (1 << 10) | (1 << 11);					//	11: 100 MHz High speed
	  //	5. Configuraci贸n de resistencias pull up/ down
	  GPIOA->PUPDR &= ~(1 << 10) & ~(1 << 11);					//	00: No pull-up, pull-down

	  //------	CONFIGURACION COMO ENTRADA DEL PIN C13
	  RCC->AHB1ENR |= (1 << 2);									//	1: IO port C clock enabled

	  GPIOC->MODER &= ~( 1 <<  (13)*2 + 0  );					//	00: Input (reset state)
	  GPIOC->MODER &= ~( 1 << ((13)*2 + 1) );

	  GPIOC->PUPDR &= ~( 1 <<  (13)*2 + 0  );					//	00: No pull-up, pull-down
	  GPIOC->PUPDR &= ~( 1 << ((13)*2 + 1) );

	for(;;){
		/*
			    actual = entrada();
			    if(actual != anterior)
			    {
			    	delay(30);

			    }
			    anterior = actual;
			   *
			   * */
			  if( !(GPIOC->IDR & (1 << 13)) )
			  {
				  GPIOA->BSRR = (1 << 5);	//	Enviar PA5 a 1
			  }else
			  {
				  GPIOA->BSRR = (1 << 21);	//	Enviar PA5 a 0
			  }
	}

	return 0;
}


void delay_ms(int time){
	int x,y;

	for(x=0;x<time;x++)
	{
		for(y=0;y<=10000;y++);
	}
}

